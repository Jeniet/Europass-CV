<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Europass CV Template</title>
    <style>
      @page {
        size: A4;
        margin: 0;
      }

      html,
      body {
        width: 210mm;
        height: 297mm;
        margin: 0;
        padding: 0;
        font-family: "Arial", sans-serif;
        font-size: 8pt;
        color: #333;
        background: #fff;
        line-height: 1.3;
        box-sizing: border-box;
      }

      .container {
        padding: 6mm 10mm;
        max-width: 190mm;
        margin: 0 auto;
        box-sizing: border-box;
      }

      .header-container {
        display: flex;
        justify-content: flex-end;
        align-items: flex-start;
        margin-bottom: 6px;
        border-bottom: 1px solid #004f9f;
      }

      .logo-container {
        width: 160px;
      }

      .logo-container img {
        width: 100%;
        height: auto;
      }

      .profile {
        display: flex;
        gap: 12px;
        margin: 6px 0;
        align-items: flex-start;
      }

      .profile-photo-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 90px;
      }

      .profile-photo {
        width: 80px;
        height: 95px;
        object-fit: cover;
        border: 1px solid #ccc;
      }

      .photo-upload-label {
        font-size: 7pt;
        color: #004f9f;
        cursor: pointer;
        margin-top: 4px;
        text-align: center;
      }

      .photo-upload-label:hover {
        text-decoration: underline;
      }

      .info-row {
        display: flex;
        align-items: center;
        margin: 3px 0;
      }

      .info-label {
        width: 70px;
        font-weight: bold;
        color: #004f9f;
      }

      .info-content {
        flex: 1;
        min-width: 0;
      }

      .section {
        margin: 10px 0;
      }

      .section-title-input {
        font-size: 10pt;
        font-weight: bold;
        color: #004f9f;
        margin-bottom: 4px;
        border: none;
        width: 100%;
        padding: 1px;
        background: none;
      }

      .section-title-input:hover,
      .section-title-input:focus {
        background: rgba(0, 79, 159, 0.02);
        outline: none;
      }

      .form-field {
        border: none;
        background: transparent;
        font-family: inherit;
        font-size: inherit;
        color: inherit;
        width: 100%;
        padding: 2px;
      }

      .form-field:hover,
      .form-field:focus {
        outline: none;
        background: rgba(0, 79, 159, 0.02);
      }

      textarea.form-field {
        resize: none;
        height: 40px;
        padding: 4px;
      }

      /* Table Styles */
      .data-table {
        width: 100%;
        border-collapse: collapse;
        margin: 6px 0; /* Reduced from 10px */
        font-size: 7.5pt; /* Reduced from 8pt */
      }

      .data-table th,
      .data-table td {
        padding: 4px 6px; /* Reduced from 6px 8px */
        border: 1px solid #ddd;
        text-align: left;
      }

      .data-table th {
        background: #f5f5f5;
        color: #004f9f;
        font-weight: bold;
      }

      .work-section,
      .skills-section,
      .language-section {
        margin: 15px 0;
        padding: 10px;
        background: #fff;
        border-radius: 4px;
      }

      .add-row-btn {
        background: none;
        border: 1px solid #004f9f;
        color: #004f9f;
        padding: 4px 12px;
        font-size: 8pt;
        border-radius: 3px;
        cursor: pointer;
        margin: 8px 0;
      }

      .delete-row-btn {
        color: #ff4444;
        background: none;
        border: none;
        cursor: pointer;
        padding: 2px 6px;
        font-size: 7pt;
      }

      ul {
        margin: 4px 0;
        padding-left: 15px;
      }

      li {
        margin-bottom: 4px;
      }

      .footer {
        margin-top: 10px;
        font-size: 7pt;
        color: #555;
      }

      p {
        margin: 4px 0;
      }

      strong,
      em {
        font-weight: bold;
        color: #333;
      }

      .editable {
        border: none;
        background: transparent;
        font-family: inherit;
        font-size: inherit;
        color: inherit;
        width: 100%;
        padding: 2px;
      }

      .editable:hover {
        background: rgba(0, 79, 159, 0.05);
        border-radius: 2px;
      }

      .editable:focus {
        outline: none;
        background: rgba(0, 79, 159, 0.08);
      }

      .button-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        display: flex;
        gap: 10px;
        z-index: 1000;
      }

      .action-button {
        padding: 8px 16px;
        background: #004f9f;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
      }

      .action-button:hover {
        background: #003b7a;
      }

      .add-button {
        background: none;
        border: 1px solid #004f9f;
        color: #004f9f;
        padding: 4px 12px;
        font-size: 8pt;
        border-radius: 3px;
        cursor: pointer;
        margin: 4px 0;
      }

      .add-button:hover {
        background: rgba(0, 79, 159, 0.05);
      }

      .delete-button {
        background: none;
        border: 1px solid #ff4444;
        color: #ff4444;
        padding: 2px 8px;
        font-size: 7pt;
        border-radius: 3px;
        cursor: pointer;
        float: right;
      }

      .delete-button:hover {
        background: rgba(255, 68, 68, 0.05);
      }

      .work-item,
      .skill-item,
      .language-item {
        border: 1px solid #eee;
        padding: 8px;
        margin: 6px 0;
        border-radius: 3px;
      }

      .table-input {
        font-size: 7.5pt; /* Match table font size */
      }

      textarea.table-input {
        min-height: 40px; /* Reduced height */
        max-height: 60px;
      }

      .edit-mode {
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #eee;
        border-radius: 4px;
      }

      .print-mode {
        display: none;
      }

      @media print {
        .button-container,
        .photo-upload-label,
        #photoUpload {
          display: none !important;
        }

        .container {
          padding: 0 10mm;
        }

        .edit-mode,
        .add-row-btn,
        .delete-row-btn {
          display: none;
        }

        /* Clean table styles for PDF */
        .data-table {
          border-collapse: collapse;
          width: 100%;
        }

        .data-table th,
        .data-table td {
          border: 1px solid #000;
          padding: 4px 6px;
          font-size: 7.5pt;
          text-align: left;
        }

        /* Remove extra elements */
        select.table-input {
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
          border: none;
          background: none;
          padding: 0;
        }

        /* Hide web-only elements */
        .add-row-btn,
        .delete-row-btn,
        select::-ms-expand,
        .table-input::-webkit-inner-spin-button,
        .table-input::-webkit-calendar-picker-indicator {
          display: none !important;
        }

        /* Remove input styling */
        .table-input {
          border: none;
          background: none;
          padding: 0;
          margin: 0;
          width: 100%;
        }

        /* Hide dropdown arrows */
        select.table-input::-ms-expand {
          display: none;
        }

        select.table-input::-webkit-outer-spin-button,
        select.table-input::-webkit-inner-spin-button {
          -webkit-appearance: none;
          margin: 0;
        }

        /* Hide empty table cells and other unwanted elements */
        td:empty {
          display: none;
        }

        /* Hide textarea resize handle */
        textarea {
          resize: none;
        }

        /* Hide textarea expanding control */
        textarea::-webkit-resizer {
          display: none;
        }

        /* Hide all empty columns in tables */
        table td:last-child:empty,
        table th:last-child:empty {
          display: none;
        }

        /* Hide any dropdown indicators */
        select {
          -webkit-appearance: none;
          -moz-appearance: none;
          appearance: none;
        }

        /* Ensure textareas appear as plain text */
        textarea.table-input {
          border: none;
          overflow: visible;
          background: none;
          resize: none;
          padding: 0;
          margin: 0;
          height: auto;
        }

        /* Hide empty columns in all table rows */
        .data-table tr td:last-child,
        .data-table tr th:last-child {
          display: none;
        }

        /* Ensure content cells span full width when last column is hidden */
        .data-table td:nth-last-child(2) {
          width: auto;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header-container">
        <div class="logo-container">
          <img src="./euro logo.jpeg" alt="Europass logo" />
        </div>
      </div>

      <div class="profile">
        <div class="profile-photo-container">
          <img
            src="./muku.png"
            alt="Profile photo"
            class="profile-photo"
            id="profileImage"
          />
          <input
            type="file"
            id="photoUpload"
            accept="image/*"
            style="display: none"
          />
          <label for="photoUpload" class="photo-upload-label"
            >Upload Photo</label
          >
        </div>

        <div class="profile-info">
          <input
            type="text"
            class="section-title-input"
            value="Ganesh Gurung"
          />
          <div class="info-row">
            <div class="info-label">Passport:</div>
            <div class="info-content">
              <input class="form-field" value="PA0556650" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">DOB:</div>
            <div class="info-content">
              <input class="form-field" value="8 May 1998" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">POB:</div>
            <div class="info-content">
              <input class="form-field" value="Sundar Haraincha 06, Nepal" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Nationality:</div>
            <div class="info-content">
              <input class="form-field" value="Nepalese" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Gender:</div>
            <div class="info-content">
              <input class="form-field" value="Male" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Phone:</div>
            <div class="info-content">
              <input class="form-field" value="(+977) 9827903555" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Other:</div>
            <div class="info-content">
              <input class="form-field" value="(+977) 9767776905" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Email:</div>
            <div class="info-content">
              <input class="form-field" value="gurungganesh355@gmail.com" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Facebook:</div>
            <div class="info-content">
              <input class="form-field" value="Ganesh Gurung" />
            </div>
          </div>
          <div class="info-row">
            <div class="info-label">Address:</div>
            <div class="info-content">
              <input
                class="form-field"
                value="Gachhiya, 56600, Morang, Nepal"
              />
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <input type="text" value="About Me" class="section-title-input" />
        <textarea class="form-field" style="width: 100%">
Motivated to thrive in a dynamic environment that fosters growth and excellence...</textarea
        >
      </div>

      <div class="section">
        <input
          type="text"
          value="Education and Training"
          class="section-title-input"
        />
        <p>
          <strong>Bachelors in Business Studies</strong>,
          <input
            type="text"
            value="Vishwa Adarsha College, Itahari, Nepal"
            class="form-field"
          />
        </p>
        <p>
          <strong>Website:</strong>
          <input type="text" value="www.vac.edu.np" class="form-field" />
        </p>
      </div>

      <!-- Language Table -->
      <div class="section">
        <input
          type="text"
          value="Language Skills"
          class="section-title-input"
        />
        <table id="languageTable" class="data-table">
          <thead>
            <tr>
              <th width="20%">Language</th>
              <th width="15%">Listening</th>
              <th width="15%">Reading</th>
              <th width="15%">Speaking</th>
              <th width="15%">Writing</th>
              <th width="15%">Overall</th>
              <th width="5%"></th>
            </tr>
          </thead>
          <tbody>
            <!-- Existing entries will be here -->
          </tbody>
        </table>
        <button class="add-row-btn" onclick="addLanguageRow()">
          + Add Language
        </button>
      </div>

      <!-- Language Proficiency Levels Info -->
      <div
        class="language-levels-info"
        style="font-size: 7pt; color: #666; margin-top: 4px"
      >
        Levels: A1/A2: Basic | B1/B2: Independent | C1/C2: Proficient (CEFR)
      </div>

      <!-- Skills Table -->
      <div class="section">
        <input type="text" value="Skills" class="section-title-input" />
        <table id="skillsTable" class="data-table">
          <thead>
            <tr>
              <th width="40%">Skill</th>
              <th width="55%">Proficiency Level</th>
              <th width="5%"></th>
            </tr>
          </thead>
          <tbody>
            <!-- Existing entries will be here -->
          </tbody>
        </table>
        <button class="add-row-btn" onclick="addSkillRow()">+ Add Skill</button>
      </div>

      <!-- Work Experience Table -->
      <div class="section">
        <input
          type="text"
          value="Work Experience"
          class="section-title-input"
        />
        <table id="workTable" class="data-table">
          <thead>
            <tr>
              <th width="25%">Company</th>
              <th width="20%">Position</th>
              <th width="15%">Duration</th>
              <th width="35%">Responsibilities</th>
              <th width="5%"></th>
            </tr>
          </thead>
          <tbody>
            <!-- Existing entries will be here -->
          </tbody>
        </table>
        <button class="add-row-btn" onclick="addWorkRow()">
          + Add Work Experience
        </button>
      </div>

      <div class="section">
        <input type="text" value="Passport" class="section-title-input" />
        <p>
          <strong>Valid:</strong>
          <input
            type="text"
            value="6 Jul 2022 – 5 Jul 2030"
            class="form-field"
          />
        </p>
        <p>
          <strong>Passport No.:</strong>
          <input type="text" value="PA0556650" class="form-field" />
        </p>
      </div>

      <div class="footer">
        <textarea class="form-field" style="width: 100%">
I hereby declare that the information provided in this resume is true and correct to the best of my knowledge and belief.</textarea
        >
      </div>

      <div class="button-container">
        <button class="action-button" onclick="window.print()">
          Export to PDF
        </button>
      </div>

      <!-- Print Mode Tables -->
      <div class="print-mode">
        <table id="workPrintTable" class="data-table">
          <thead>
            <tr>
              <th width="25%">Company</th>
              <th width="20%">Position</th>
              <th width="15%">Duration</th>
              <th width="35%">Responsibilities</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="print-mode">
        <table id="skillsPrintTable" class="data-table">
          <thead>
            <tr>
              <th width="40%">Skill</th>
              <th width="55%">Proficiency Level</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="print-mode">
        <table id="languagePrintTable" class="data-table">
          <thead>
            <tr>
              <th width="20%">Language</th>
              <th width="15%">Listening</th>
              <th width="15%">Reading</th>
              <th width="15%">Speaking</th>
              <th width="15%">Writing</th>
              <th width="15%">Overall</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <p class="language-levels-info" style="font-size: 7pt; color: #666">
          Levels: A1/A2: Basic User | B1/B2: Independent User | C1/C2:
          Proficient User (CEFR)
        </p>
      </div>
    </div>

    <script>
      document
        .getElementById("photoUpload")
        .addEventListener("change", function (event) {
          const file = event.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              document.getElementById("profileImage").src = e.target.result;
            };
            reader.readAsDataURL(file);
          }
        });

      // Make everything editable
      document
        .querySelectorAll("p, h1, h2, h3, h4, h5, h6, td, th, li, strong, em")
        .forEach((element) => {
          if (!element.querySelector("input, textarea")) {
            element.contentEditable = true;
            element.classList.add("editable");
          }
        });

      function addNewWork() {
        const workList = document.getElementById("workList");
        const newWork = document.createElement("div");
        newWork.className = "work-item";
        newWork.innerHTML = `
        <button class="delete-button" onclick="this.parentElement.remove()">Delete</button>
        <p><strong><input type="text" class="form-field" placeholder="Company Name" /></strong></p>
        <p><strong><input type="text" class="form-field" placeholder="Position & Duration" /></strong></p>
        <ul>
          <li><input type="text" class="form-field" placeholder="Responsibility" /></li>
          <li><input type="text" class="form-field" placeholder="Responsibility" /></li>
          <li><input type="text" class="form-field" placeholder="Responsibility" /></li>
        </ul>
      `;
        workList.appendChild(newWork);
      }

      function addNewSkill() {
        const skillsList = document.getElementById("skillsList");
        const newSkill = document.createElement("div");
        newSkill.className = "skill-item";
        newSkill.innerHTML = `
        <button class="delete-button" onclick="this.parentElement.remove()">Delete</button>
        <input type="text" class="form-field" placeholder="Skill" />
        <select class="form-field">
          <option value="basic">Basic</option>
          <option value="intermediate">Intermediate</option>
          <option value="advanced">Advanced</option>
        </select>
      `;
        skillsList.appendChild(newSkill);
      }

      function addNewLanguage() {
        const languagesList = document.getElementById("languagesList");
        const newRow = document.createElement("tr");
        newRow.innerHTML = `
        <td><input type="text" class="form-field" placeholder="Language" /></td>
        <td><input type="text" class="form-field" value="B2" /></td>
        <td><input type="text" class="form-field" value="C1" /></td>
        <td><input type="text" class="form-field" value="C1" /></td>
        <td><input type="text" class="form-field" value="C1" /></td>
        <td><input type="text" class="form-field" value="C1" /></td>
      `;
        languagesList.appendChild(newRow);
      }

      function addWorkRow() {
        const tbody = document.querySelector('#workTable tbody');
        const row = tbody.insertRow();
        row.innerHTML = `
            <td><input type="text" class="table-input" placeholder="Company Name"></td>
            <td><input type="text" class="table-input" placeholder="Position"></td>
            <td><input type="text" class="table-input" placeholder="Duration"></td>
            <td style="width: 100%"><textarea class="table-input" placeholder="Key responsibilities" rows="3"></textarea></td>
            <td class="action-column"><button class="delete-row-btn" onclick="this.closest('tr').remove()">×</button></td>
        `;
      }

      function addSkillRow() {
        const tbody = document.querySelector('#skillsTable tbody');
        const row = tbody.insertRow();
        row.innerHTML = `
            <td style="width: 60%"><input type="text" class="table-input" placeholder="Skill name"></td>
            <td style="width: 40%"><select class="table-input">
                <option value="basic">Basic</option>
                <option value="intermediate">Intermediate</option>
                <option value="advanced">Advanced</option>
                <option value="expert">Expert</option>
            </select></td>
            <td class="action-column"><button class="delete-row-btn" onclick="this.closest('tr').remove()">×</button></td>
        `;
      }

      function addLanguageRow() {
        const tbody = document.querySelector("#languageTable tbody");
        const row = tbody.insertRow();
        row.innerHTML = `
          <td><input type="text" class="table-input" placeholder="Language"></td>
          <td>
              <select class="table-input">
                  <option value="A1">A1</option>
                  <option value="A2">A2</option>
                  <option value="B1">B1</option>
                  <option value="B2">B2</option>
                  <option value="C1">C1</option>
                  <option value="C2">C2</option>
              </select>
          </td>
          <td>
              <select class="table-input">
                  <option value="A1">A1</option>
                  <option value="A2">A2</option>
                  <option value="B1">B1</option>
                  <option value="B2">B2</option>
                  <option value="C1">C1</option>
                  <option value="C2">C2</option>
              </select>
          </td>
          <td>
              <select class="table-input">
                  <option value="A1">A1</option>
                  <option value="A2">A2</option>
                  <option value="B1">B1</option>
                  <option value="B2">B2</option>
                  <option value="C1">C1</option>
                  <option value="C2">C2</option>
              </select>
          </td>
          <td>
              <select class="table-input">
                  <option value="A1">A1</option>
                  <option value="A2">A2</option>
                  <option value="B1">B1</option>
                  <option value="B2">B2</option>
                  <option value="C1">C1</option>
                  <option value="C2">C2</option>
              </select>
          </td>
          <td>
              <select class="table-input">
                  <option value="A1">A1</option>
                  <option value="A2">A2</option>
                  <option value="B1">B1</option>
                  <option value="B2">B2</option>
                  <option value="C1">C1</option>
                  <option value="C2">C2</option>
              </select>
          </td>
          <td><button class="delete-row-btn" onclick="this.closest('tr').remove()">×</button></td>
      `;
      }

      function updatePrintView() {
        // Work Experience
        let workPrint = document.getElementById("workPrintTable");
        let workRows = "";
        document.querySelectorAll("#workList .work-item").forEach((item) => {
          workRows += `<tr>
            <td>${item.querySelector(".company-input").value}</td>
            <td>${item.querySelector(".position-input").value}</td>
            <td>${item.querySelector(".duration-input").value}</td>
            <td>${item.querySelector(".description-input").value}</td>
        </tr>`;
        });
        workPrint.querySelector("tbody").innerHTML = workRows;

        // Skills
        let skillsPrint = document.getElementById("skillsPrintTable");
        let skillRows = "";
        document.querySelectorAll("#skillsList .skill-item").forEach((item) => {
          skillRows += `<tr>
            <td>${item.querySelector(".skill-input").value}</td>
            <td>${item.querySelector(".skill-level").value}</td>
        </tr>`;
        });
        skillsPrint.querySelector("tbody").innerHTML = skillRows;

        // Languages
        let langPrint = document.getElementById("languagePrintTable");
        let langRows = "";
        document
          .querySelectorAll("#languagesList .language-item")
          .forEach((item) => {
            langRows += `<tr>
            <td>${item.querySelector(".language-input").value}</td>
            <td>${item.querySelector('select[name="listening"]').value}</td>
            <td>${item.querySelector('select[name="reading"]').value}</td>
            <td>${item.querySelector('select[name="speaking"]').value}</td>
            <td>${item.querySelector('select[name="writing"]').value}</td>
        </tr>`;
          });
        langPrint.querySelector("tbody").innerHTML = langRows;
      }

      // Modify print button click handler
      document.querySelector(".action-button").onclick = function () {
        updatePrintView();
        window.print();
      };
    </script>
  </body>
</html>
